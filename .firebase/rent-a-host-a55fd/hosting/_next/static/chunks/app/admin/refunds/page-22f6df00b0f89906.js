(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5814],{3399:(e,s,t)=>{Promise.resolve().then(t.bind(t,4625))},6046:(e,s,t)=>{"use strict";var r=t(6658);t.o(r,"usePathname")&&t.d(s,{usePathname:function(){return r.usePathname}}),t.o(r,"useRouter")&&t.d(s,{useRouter:function(){return r.useRouter}}),t.o(r,"useSearchParams")&&t.d(s,{useSearchParams:function(){return r.useSearchParams}})},4625:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>g});var r=t(5155),a=t(2115),n=t(3312),d=t(9749),l=t(2508),i=t(5564),o=t(301),c=t(2783),u=t(4815),m=t(288),f=t(6814),x=t(7058),h=t(6719),p=t(7960),j=t(6046),N=t(7081);function g(){let{toast:e}=(0,i.dj)(),s=(0,f.useFirestore)(),{isPlatformOwner:t,isLoading:g}=(0,m.z)(),[v,b]=(0,a.useState)(null),y=(0,j.useRouter)(),[w,T]=(0,a.useState)(!1);(0,a.useEffect)(()=>{T(!0)},[]),(0,a.useEffect)(()=>{g||t||y.push("/dashboard")},[t,g,y]);let A=(0,f.useMemoFirebase)(()=>s&&t?(0,x.P)((0,x.Cs)(s,"refundRequests")):null,[s,t]),{data:R,isLoading:S}=(0,f.useCollection)(A),E=async t=>{if(!s)return;b(t.id);let r=(0,x.H9)(s,"users",t.userId,"refundRequests",t.id);(0,f.updateDocumentNonBlocking)(r,{status:"processed"}),e({title:"Refund Processed",description:"Refund for ".concat(t.userEmail," has been marked as processed.")}),setTimeout(()=>{b(null)},1500)},_=(0,a.useMemo)(()=>{var e;return null!==(e=null==R?void 0:R.filter(e=>"pending"===e.status))&&void 0!==e?e:[]},[R]),C=(0,a.useMemo)(()=>{var e;return null!==(e=null==R?void 0:R.filter(e=>"processed"===e.status).reduce((e,s)=>e+(s.amount||0),0))&&void 0!==e?e:0},[R]),D=t||g;return(0,r.jsxs)("div",{className:"space-y-8 animate-in fade-in duration-300",children:[(0,r.jsxs)("div",{children:[(0,r.jsx)("h1",{className:"text-3xl font-bold font-headline heading-red",children:"Manage Refunds"}),(0,r.jsx)("p",{className:"text-muted-foreground",children:"Review and process user refund requests."})]}),(0,r.jsx)("div",{className:"grid gap-4 md:grid-cols-2",children:(0,r.jsx)(p.h,{title:"Total Refunded",value:!D||S?"...":"$".concat(C.toLocaleString("en-US",{minimumFractionDigits:2,maximumFractionDigits:2})),icon:(0,r.jsx)(o.A,{className:"h-5 w-5 text-muted-foreground"}),description:"Total amount processed for refunds."})}),(0,r.jsxs)(d.Zp,{children:[(0,r.jsxs)(d.aR,{children:[(0,r.jsx)(d.ZB,{children:"Pending Refund Requests"}),(0,r.jsx)(d.BT,{children:!D||S?"Loading requests...":(0,r.jsxs)(r.Fragment,{children:["There are currently ",(0,r.jsx)("span",{className:"font-bold text-primary",children:_.length})," pending refund requests."]})})]}),(0,r.jsx)(d.Wu,{children:!D||S?(0,r.jsxs)("div",{className:"space-y-3",children:[(0,r.jsx)(N.E,{className:"h-10 w-full"}),(0,r.jsx)(N.E,{className:"h-10 w-full"})]}):_.length>0?(0,r.jsxs)(l.XI,{children:[(0,r.jsx)(l.A0,{children:(0,r.jsxs)(l.Hj,{children:[(0,r.jsx)(l.nd,{children:"Username"}),(0,r.jsx)(l.nd,{children:"Email"}),(0,r.jsx)(l.nd,{children:"Amount"}),(0,r.jsx)(l.nd,{children:"Reason"}),(0,r.jsx)(l.nd,{children:"Date"}),(0,r.jsx)(l.nd,{className:"text-right",children:"Action"})]})}),(0,r.jsx)(l.BF,{children:_.map(e=>{var s;return(0,r.jsxs)(l.Hj,{children:[(0,r.jsx)(l.nA,{className:"font-medium",children:e.userUsername}),(0,r.jsx)(l.nA,{children:e.userEmail}),(0,r.jsxs)(l.nA,{children:["$",(null!==(s=e.amount)&&void 0!==s?s:0).toFixed(2)]}),(0,r.jsx)(l.nA,{className:"max-w-xs truncate",children:e.reason}),(0,r.jsx)(l.nA,{children:w&&e.requestedAt?(0,h.GP)(e.requestedAt.toDate(),"PP"):"..."}),(0,r.jsx)(l.nA,{className:"text-right",children:(0,r.jsxs)(n.$,{variant:"outline",size:"sm",onClick:()=>E(e),disabled:v===e.id,children:[v===e.id?(0,r.jsx)(c.A,{className:"mr-2 h-4 w-4 animate-spin"}):(0,r.jsx)(u.A,{className:"mr-2 h-4 w-4"}),"Process Refund"]})})]},e.id)})})]}):(0,r.jsxs)("div",{className:"text-center text-muted-foreground py-10",children:[(0,r.jsx)(u.A,{className:"mx-auto h-12 w-12 text-gray-400"}),(0,r.jsx)("p",{className:"mt-4 font-semibold",children:"All caught up!"}),(0,r.jsx)("p",{className:"text-sm",children:"There are no pending refund requests."})]})})]})]})}},7960:(e,s,t)=>{"use strict";t.d(s,{h:()=>d});var r=t(5155),a=t(9749),n=t(1567);function d(e){let{title:s,value:t,icon:d,description:l,className:i}=e;return(0,r.jsxs)(a.Zp,{className:(0,n.cn)("overflow-hidden",i),children:[(0,r.jsxs)(a.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,r.jsx)(a.ZB,{className:"text-sm font-medium",children:s}),(0,r.jsx)("div",{className:"[&>svg]:h-5 [&>svg]:w-5 [&>svg]:text-muted-foreground",children:d})]}),(0,r.jsxs)(a.Wu,{children:[(0,r.jsx)("div",{className:"text-2xl font-bold",children:t}),l&&(0,r.jsx)("p",{className:"text-xs text-muted-foreground",children:l})]})]})}},9749:(e,s,t)=>{"use strict";t.d(s,{BT:()=>o,Wu:()=>c,ZB:()=>i,Zp:()=>d,aR:()=>l,wL:()=>u});var r=t(5155),a=t(2115),n=t(1567);let d=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("div",{ref:s,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...a})});d.displayName="Card";let l=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("div",{ref:s,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",t),...a})});l.displayName="CardHeader";let i=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("h3",{ref:s,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",t),...a})});i.displayName="CardTitle";let o=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("p",{ref:s,className:(0,n.cn)("text-sm text-muted-foreground",t),...a})});o.displayName="CardDescription";let c=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("div",{ref:s,className:(0,n.cn)("p-6 pt-0",t),...a})});c.displayName="CardContent";let u=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("div",{ref:s,className:(0,n.cn)("flex items-center p-6 pt-0",t),...a})});u.displayName="CardFooter"},7081:(e,s,t)=>{"use strict";t.d(s,{E:()=>n});var r=t(5155),a=t(1567);function n(e){let{className:s,...t}=e;return(0,r.jsx)("div",{className:(0,a.cn)("animate-pulse rounded-md bg-muted",s),...t})}},2508:(e,s,t)=>{"use strict";t.d(s,{A0:()=>l,BF:()=>i,Hj:()=>o,XI:()=>d,nA:()=>u,nd:()=>c});var r=t(5155),a=t(2115),n=t(1567);let d=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("div",{className:"relative w-full overflow-auto",children:(0,r.jsx)("table",{ref:s,className:(0,n.cn)("w-full caption-bottom text-sm",t),...a})})});d.displayName="Table";let l=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("thead",{ref:s,className:(0,n.cn)("[&_tr]:border-b",t),...a})});l.displayName="TableHeader";let i=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("tbody",{ref:s,className:(0,n.cn)("[&_tr:last-child]:border-0",t),...a})});i.displayName="TableBody",a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("tfoot",{ref:s,className:(0,n.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...a})}).displayName="TableFooter";let o=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("tr",{ref:s,className:(0,n.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...a})});o.displayName="TableRow";let c=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("th",{ref:s,className:(0,n.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...a})});c.displayName="TableHead";let u=a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("td",{ref:s,className:(0,n.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...a})});u.displayName="TableCell",a.forwardRef((e,s)=>{let{className:t,...a}=e;return(0,r.jsx)("caption",{ref:s,className:(0,n.cn)("mt-4 text-sm text-muted-foreground",t),...a})}).displayName="TableCaption"},288:(e,s,t)=>{"use strict";t.d(s,{z:()=>d});var r=t(6814),a=t(7058),n=t(2115);function d(){let{user:e,isUserLoading:s}=(0,r.useUser)(),t=(0,r.useFirestore)(),[d,l]=(0,n.useState)(!1),[i,o]=(0,n.useState)(!1),[c,u]=(0,n.useState)(!0),m=["rentapog@gmail.com","grantrizzo2@gmail.com"];return(0,n.useEffect)(()=>{var r;if(s)return;if(!e){l(!1),o(!1),u(!1);return}let n=null===(r=e.email)||void 0===r?void 0:r.toLowerCase();if(n&&m.includes(n)){l(!0),o(!0),u(!1);return}(async()=>{try{if(!t)return;let s=(0,a.H9)(t,"roles_admin",e.uid);(await (0,a.x7)(s)).exists()&&l(!0)}catch(e){}finally{u(!1)}})()},[null==e?void 0:e.uid,s,t]),{isAdmin:d,isPlatformOwner:i,isLoading:c}}},5564:(e,s,t)=>{"use strict";t.d(s,{dj:()=>m});var r=t(2115);let a=0,n=new Map,d=e=>{if(n.has(e))return;let s=setTimeout(()=>{n.delete(e),c({type:"REMOVE_TOAST",toastId:e})},1e6);n.set(e,s)},l=(e,s)=>{switch(s.type){case"ADD_TOAST":return{...e,toasts:[s.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===s.toast.id?{...e,...s.toast}:e)};case"DISMISS_TOAST":{let{toastId:t}=s;return t?d(t):e.toasts.forEach(e=>{d(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===t||void 0===t?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===s.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==s.toastId)}}},i=[],o={toasts:[]};function c(e){o=l(o,e),i.forEach(e=>{e(o)})}function u(e){let{...s}=e,t=(a=(a+1)%Number.MAX_SAFE_INTEGER).toString(),r=()=>c({type:"DISMISS_TOAST",toastId:t});return c({type:"ADD_TOAST",toast:{...s,id:t,open:!0,onOpenChange:e=>{e||r()}}}),{id:t,dismiss:r,update:e=>c({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function m(){let[e,s]=r.useState(o);return r.useEffect(()=>(i.push(s),()=>{let e=i.indexOf(s);e>-1&&i.splice(e,1)}),[e]),{...e,toast:u,dismiss:e=>c({type:"DISMISS_TOAST",toastId:e})}}},301:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(4057).A)("DollarSign",[["line",{x1:"12",x2:"12",y1:"2",y2:"22",key:"7eqyqh"}],["path",{d:"M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6",key:"1b0p4s"}]])},4815:(e,s,t)=>{"use strict";t.d(s,{A:()=>r});let r=(0,t(4057).A)("ShieldCheck",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}],["path",{d:"m9 12 2 2 4-4",key:"dzmm74"}]])}},e=>{var s=s=>e(e.s=s);e.O(0,[2992,3644,8249,9680,615,9100,6814,8441,1517,7358],()=>s(3399)),_N_E=e.O()}]);