(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8733],{342:(e,r,t)=>{Promise.resolve().then(t.bind(t,6818))},6046:(e,r,t)=>{"use strict";var a=t(6658);t.o(a,"usePathname")&&t.d(r,{usePathname:function(){return a.usePathname}}),t.o(a,"useRouter")&&t.d(r,{useRouter:function(){return a.useRouter}}),t.o(a,"useSearchParams")&&t.d(r,{useSearchParams:function(){return a.useSearchParams}})},6818:(e,r,t)=>{"use strict";t.r(r),t.d(r,{default:()=>w});var a=t(5155),s=t(2115),n=t(3312),l=t(9749),i=t(2508),o=t(5564),d=t(4057);let u=(0,d.A)("Crown",[["path",{d:"M11.562 3.266a.5.5 0 0 1 .876 0L15.39 8.87a1 1 0 0 0 1.516.294L21.183 5.5a.5.5 0 0 1 .798.519l-2.834 10.246a1 1 0 0 1-.956.734H5.81a1 1 0 0 1-.957-.734L2.02 6.02a.5.5 0 0 1 .798-.519l4.276 3.664a1 1 0 0 0 1.516-.294z",key:"1vdc57"}],["path",{d:"M5 21h14",key:"11awu3"}]]),c=(0,d.A)("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]);var f=t(2783);let m=(0,d.A)("ShieldOff",[["path",{d:"m2 2 20 20",key:"1ooewy"}],["path",{d:"M5 5a1 1 0 0 0-1 1v7c0 5 3.5 7.5 7.67 8.94a1 1 0 0 0 .67.01c2.35-.82 4.48-1.97 5.9-3.71",key:"1jlk70"}],["path",{d:"M9.309 3.652A12.252 12.252 0 0 0 11.24 2.28a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1v7a9.784 9.784 0 0 1-.08 1.264",key:"18rp1v"}]]);var p=t(288),h=t(6814),x=t(7058),v=t(5121),g=t(5055),y=t(7081),N=t(6046);function j(){return(0,a.jsxs)("div",{className:"space-y-3",children:[(0,a.jsx)(y.E,{className:"h-12 w-full"}),(0,a.jsx)(y.E,{className:"h-12 w-full"}),(0,a.jsx)(y.E,{className:"h-12 w-full"})]})}function w(){let{toast:e}=(0,o.dj)(),r=(0,h.useFirestore)(),t=(0,N.useRouter)(),{isPlatformOwner:d,isLoading:y}=(0,p.z)(),[w,b]=(0,s.useState)(null);(0,s.useEffect)(()=>{y||d||t.push("/dashboard")},[d,y,t]);let S=(0,h.useMemoFirebase)(()=>r&&d?(0,x.rJ)(r,"users"):null,[r,d]),{data:R,isLoading:A}=(0,h.useCollection)(S),E=(0,h.useMemoFirebase)(()=>r&&d?(0,x.rJ)(r,"roles_admin"):null,[r,d]),{data:T,isLoading:C}=(0,h.useCollection)(E),_=(0,s.useMemo)(()=>{var e;return new Set(null!==(e=null==T?void 0:T.map(e=>e.id))&&void 0!==e?e:[])},[T]),k=async t=>{if(!r)return;let a=_.has(t.id);if("rentapog@gmail.com"===t.email)return;b(t.id);let s=(0,x.H9)(r,"roles_admin",t.id);try{a?(await (0,x.kd)(s),e({title:"Admin Revoked",description:"".concat(t.username," is no longer an admin.")})):(await (0,x.BN)(s,{}),e({title:"Admin Granted",description:"".concat(t.username," is now an admin.")}))}catch(r){e({variant:"destructive",title:"Error",description:r.message})}finally{b(null)}};return(0,a.jsxs)("div",{className:"space-y-8",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("h1",{className:"text-3xl font-bold font-headline heading-red",children:"Manage Users"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Grant or revoke administrative privileges."})]}),(0,a.jsxs)(l.Zp,{children:[(0,a.jsxs)(l.aR,{children:[(0,a.jsx)(l.ZB,{children:"Platform Directory"}),(0,a.jsx)(l.BT,{children:"Manage roles for all registered users."})]}),(0,a.jsx)(l.Wu,{children:y||A||C?(0,a.jsx)(j,{}):R&&R.length>0?(0,a.jsxs)(i.XI,{children:[(0,a.jsx)(i.A0,{children:(0,a.jsxs)(i.Hj,{children:[(0,a.jsx)(i.nd,{children:"User"}),(0,a.jsx)(i.nd,{children:"Status"}),(0,a.jsx)(i.nd,{className:"text-right",children:"Action"})]})}),(0,a.jsx)(i.BF,{children:R.map(e=>{var r;return(0,a.jsxs)(i.Hj,{children:[(0,a.jsx)(i.nA,{className:"font-medium",children:(0,a.jsxs)("div",{className:"flex items-center gap-3",children:[(0,a.jsxs)(g.eu,{className:"h-8 w-8",children:[(0,a.jsx)(g.BK,{src:"https://picsum.photos/seed/".concat(e.id,"/100/100")}),(0,a.jsx)(g.q5,{children:null===(r=e.username)||void 0===r?void 0:r.charAt(0).toUpperCase()})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"font-semibold text-sm",children:e.username}),(0,a.jsx)("p",{className:"text-xs text-muted-foreground",children:e.email})]})]})}),(0,a.jsx)(i.nA,{children:_.has(e.id)?(0,a.jsxs)(v.E,{className:"bg-primary",children:[(0,a.jsx)(u,{className:"mr-2 h-3 w-3"})," Admin"]}):(0,a.jsxs)(v.E,{variant:"secondary",children:[(0,a.jsx)(c,{className:"mr-2 h-3 w-3"})," User"]})}),(0,a.jsx)(i.nA,{className:"text-right",children:(0,a.jsxs)(n.$,{variant:"outline",size:"sm",onClick:()=>k(e),disabled:w===e.id||"rentapog@gmail.com"===e.email,children:[w===e.id?(0,a.jsx)(f.A,{className:"mr-2 h-4 w-4 animate-spin"}):_.has(e.id)?(0,a.jsx)(m,{className:"mr-2 h-4 w-4"}):(0,a.jsx)(u,{className:"mr-2 h-4 w-4"}),_.has(e.id)?"Revoke":"Grant"]})})]},e.id)})})]}):(0,a.jsx)("div",{className:"text-center text-muted-foreground py-10 border-2 border-dashed rounded-lg bg-slate-50/50",children:(0,a.jsx)("p",{children:"No users found on the platform yet."})})})]})]})}},5055:(e,r,t)=>{"use strict";t.d(r,{BK:()=>o,eu:()=>i,q5:()=>d});var a=t(5155),s=t(2115),n=t(4920),l=t(1567);let i=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)(n.bL,{ref:r,className:(0,l.cn)("relative flex h-10 w-10 shrink-0 overflow-hidden rounded-full",t),...s})});i.displayName=n.bL.displayName;let o=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)(n._V,{ref:r,className:(0,l.cn)("aspect-square h-full w-full",t),...s})});o.displayName=n._V.displayName;let d=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)(n.H4,{ref:r,className:(0,l.cn)("flex h-full w-full items-center justify-center rounded-full bg-muted",t),...s})});d.displayName=n.H4.displayName},5121:(e,r,t)=>{"use strict";t.d(r,{E:()=>i});var a=t(5155);t(2115);var s=t(1027),n=t(1567);let l=(0,s.F)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:r,variant:t,...s}=e;return(0,a.jsx)("div",{className:(0,n.cn)(l({variant:t}),r),...s})}},9749:(e,r,t)=>{"use strict";t.d(r,{BT:()=>d,Wu:()=>u,ZB:()=>o,Zp:()=>l,aR:()=>i,wL:()=>c});var a=t(5155),s=t(2115),n=t(1567);let l=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,n.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",t),...s})});l.displayName="Card";let i=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,n.cn)("flex flex-col space-y-1.5 p-6",t),...s})});i.displayName="CardHeader";let o=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("h3",{ref:r,className:(0,n.cn)("text-2xl font-semibold leading-none tracking-tight",t),...s})});o.displayName="CardTitle";let d=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("p",{ref:r,className:(0,n.cn)("text-sm text-muted-foreground",t),...s})});d.displayName="CardDescription";let u=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,n.cn)("p-6 pt-0",t),...s})});u.displayName="CardContent";let c=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{ref:r,className:(0,n.cn)("flex items-center p-6 pt-0",t),...s})});c.displayName="CardFooter"},7081:(e,r,t)=>{"use strict";t.d(r,{E:()=>n});var a=t(5155),s=t(1567);function n(e){let{className:r,...t}=e;return(0,a.jsx)("div",{className:(0,s.cn)("animate-pulse rounded-md bg-muted",r),...t})}},2508:(e,r,t)=>{"use strict";t.d(r,{A0:()=>i,BF:()=>o,Hj:()=>d,XI:()=>l,nA:()=>c,nd:()=>u});var a=t(5155),s=t(2115),n=t(1567);let l=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("div",{className:"relative w-full overflow-auto",children:(0,a.jsx)("table",{ref:r,className:(0,n.cn)("w-full caption-bottom text-sm",t),...s})})});l.displayName="Table";let i=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("thead",{ref:r,className:(0,n.cn)("[&_tr]:border-b",t),...s})});i.displayName="TableHeader";let o=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("tbody",{ref:r,className:(0,n.cn)("[&_tr:last-child]:border-0",t),...s})});o.displayName="TableBody",s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("tfoot",{ref:r,className:(0,n.cn)("border-t bg-muted/50 font-medium [&>tr]:last:border-b-0",t),...s})}).displayName="TableFooter";let d=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("tr",{ref:r,className:(0,n.cn)("border-b transition-colors hover:bg-muted/50 data-[state=selected]:bg-muted",t),...s})});d.displayName="TableRow";let u=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("th",{ref:r,className:(0,n.cn)("h-12 px-4 text-left align-middle font-medium text-muted-foreground [&:has([role=checkbox])]:pr-0",t),...s})});u.displayName="TableHead";let c=s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("td",{ref:r,className:(0,n.cn)("p-4 align-middle [&:has([role=checkbox])]:pr-0",t),...s})});c.displayName="TableCell",s.forwardRef((e,r)=>{let{className:t,...s}=e;return(0,a.jsx)("caption",{ref:r,className:(0,n.cn)("mt-4 text-sm text-muted-foreground",t),...s})}).displayName="TableCaption"},288:(e,r,t)=>{"use strict";t.d(r,{z:()=>l});var a=t(6814),s=t(7058),n=t(2115);function l(){let{user:e,isUserLoading:r}=(0,a.useUser)(),t=(0,a.useFirestore)(),[l,i]=(0,n.useState)(!1),[o,d]=(0,n.useState)(!1),[u,c]=(0,n.useState)(!0),f=["rentapog@gmail.com","grantrizzo2@gmail.com"];return(0,n.useEffect)(()=>{var a;if(r)return;if(!e){i(!1),d(!1),c(!1);return}let n=null===(a=e.email)||void 0===a?void 0:a.toLowerCase();if(n&&f.includes(n)){i(!0),d(!0),c(!1);return}(async()=>{try{if(!t)return;let r=(0,s.H9)(t,"roles_admin",e.uid);(await (0,s.x7)(r)).exists()&&i(!0)}catch(e){}finally{c(!1)}})()},[null==e?void 0:e.uid,r,t]),{isAdmin:l,isPlatformOwner:o,isLoading:u}}},5564:(e,r,t)=>{"use strict";t.d(r,{dj:()=>f});var a=t(2115);let s=0,n=new Map,l=e=>{if(n.has(e))return;let r=setTimeout(()=>{n.delete(e),u({type:"REMOVE_TOAST",toastId:e})},1e6);n.set(e,r)},i=(e,r)=>{switch(r.type){case"ADD_TOAST":return{...e,toasts:[r.toast,...e.toasts].slice(0,1)};case"UPDATE_TOAST":return{...e,toasts:e.toasts.map(e=>e.id===r.toast.id?{...e,...r.toast}:e)};case"DISMISS_TOAST":{let{toastId:t}=r;return t?l(t):e.toasts.forEach(e=>{l(e.id)}),{...e,toasts:e.toasts.map(e=>e.id===t||void 0===t?{...e,open:!1}:e)}}case"REMOVE_TOAST":if(void 0===r.toastId)return{...e,toasts:[]};return{...e,toasts:e.toasts.filter(e=>e.id!==r.toastId)}}},o=[],d={toasts:[]};function u(e){d=i(d,e),o.forEach(e=>{e(d)})}function c(e){let{...r}=e,t=(s=(s+1)%Number.MAX_SAFE_INTEGER).toString(),a=()=>u({type:"DISMISS_TOAST",toastId:t});return u({type:"ADD_TOAST",toast:{...r,id:t,open:!0,onOpenChange:e=>{e||a()}}}),{id:t,dismiss:a,update:e=>u({type:"UPDATE_TOAST",toast:{...e,id:t}})}}function f(){let[e,r]=a.useState(d);return a.useEffect(()=>(o.push(r),()=>{let e=o.indexOf(r);e>-1&&o.splice(e,1)}),[e]),{...e,toast:c,dismiss:e=>u({type:"DISMISS_TOAST",toastId:e})}}},4920:(e,r,t)=>{"use strict";t.d(r,{H4:()=>j,_V:()=>N,bL:()=>y});var a=t(2115),s=t(8166),n=t(1524),l=t(6611),i=t(9997),o=t(5155),d="Avatar",[u,c]=(0,s.A)(d),[f,m]=u(d),p=a.forwardRef((e,r)=>{let{__scopeAvatar:t,...s}=e,[n,l]=a.useState("idle");return(0,o.jsx)(f,{scope:t,imageLoadingStatus:n,onImageLoadingStatusChange:l,children:(0,o.jsx)(i.sG.span,{...s,ref:r})})});p.displayName=d;var h="AvatarImage",x=a.forwardRef((e,r)=>{let{__scopeAvatar:t,src:s,onLoadingStatusChange:d=()=>{},...u}=e,c=m(h,t),f=function(e,r){let[t,s]=a.useState("idle");return(0,l.N)(()=>{if(!e){s("error");return}let t=!0,a=new window.Image,n=e=>()=>{t&&s(e)};return s("loading"),a.onload=n("loaded"),a.onerror=n("error"),a.src=e,r&&(a.referrerPolicy=r),()=>{t=!1}},[e,r]),t}(s,u.referrerPolicy),p=(0,n.c)(e=>{d(e),c.onImageLoadingStatusChange(e)});return(0,l.N)(()=>{"idle"!==f&&p(f)},[f,p]),"loaded"===f?(0,o.jsx)(i.sG.img,{...u,ref:r,src:s}):null});x.displayName=h;var v="AvatarFallback",g=a.forwardRef((e,r)=>{let{__scopeAvatar:t,delayMs:s,...n}=e,l=m(v,t),[d,u]=a.useState(void 0===s);return a.useEffect(()=>{if(void 0!==s){let e=window.setTimeout(()=>u(!0),s);return()=>window.clearTimeout(e)}},[s]),d&&"loaded"!==l.imageLoadingStatus?(0,o.jsx)(i.sG.span,{...n,ref:r}):null});g.displayName=v;var y=p,N=x,j=g},8068:(e,r,t)=>{"use strict";t.d(r,{s:()=>l,t:()=>n});var a=t(2115);function s(e,r){if("function"==typeof e)return e(r);null!=e&&(e.current=r)}function n(...e){return r=>{let t=!1,a=e.map(e=>{let a=s(e,r);return t||"function"!=typeof a||(t=!0),a});if(t)return()=>{for(let r=0;r<a.length;r++){let t=a[r];"function"==typeof t?t():s(e[r],null)}}}}function l(...e){return a.useCallback(n(...e),e)}},8166:(e,r,t)=>{"use strict";t.d(r,{A:()=>n});var a=t(2115),s=t(5155);function n(e,r=[]){let t=[],l=()=>{let r=t.map(e=>a.createContext(e));return function(t){let s=t?.[e]||r;return a.useMemo(()=>({[`__scope${e}`]:{...t,[e]:s}}),[t,s])}};return l.scopeName=e,[function(r,n){let l=a.createContext(n),i=t.length;t=[...t,n];let o=r=>{let{scope:t,children:n,...o}=r,d=t?.[e]?.[i]||l,u=a.useMemo(()=>o,Object.values(o));return(0,s.jsx)(d.Provider,{value:u,children:n})};return o.displayName=r+"Provider",[o,function(t,s){let o=s?.[e]?.[i]||l,d=a.useContext(o);if(d)return d;if(void 0!==n)return n;throw Error(`\`${t}\` must be used within \`${r}\``)}]},function(...e){let r=e[0];if(1===e.length)return r;let t=()=>{let t=e.map(e=>({useScope:e(),scopeName:e.scopeName}));return function(e){let s=t.reduce((r,{useScope:t,scopeName:a})=>{let s=t(e)[`__scope${a}`];return{...r,...s}},{});return a.useMemo(()=>({[`__scope${r.scopeName}`]:s}),[s])}};return t.scopeName=r.scopeName,t}(l,...r)]}},9997:(e,r,t)=>{"use strict";t.d(r,{sG:()=>c,hO:()=>f});var a=t(2115),s=t(7650),n=t(8068),l=t(5155),i=a.forwardRef((e,r)=>{let{children:t,...s}=e,n=a.Children.toArray(t),i=n.find(u);if(i){let e=i.props.children,t=n.map(r=>r!==i?r:a.Children.count(e)>1?a.Children.only(null):a.isValidElement(e)?e.props.children:null);return(0,l.jsx)(o,{...s,ref:r,children:a.isValidElement(e)?a.cloneElement(e,void 0,t):null})}return(0,l.jsx)(o,{...s,ref:r,children:t})});i.displayName="Slot";var o=a.forwardRef((e,r)=>{let{children:t,...s}=e;if(a.isValidElement(t)){let e=function(e){let r=Object.getOwnPropertyDescriptor(e.props,"ref")?.get,t=r&&"isReactWarning"in r&&r.isReactWarning;return t?e.ref:(t=(r=Object.getOwnPropertyDescriptor(e,"ref")?.get)&&"isReactWarning"in r&&r.isReactWarning)?e.props.ref:e.props.ref||e.ref}(t),l=function(e,r){let t={...r};for(let a in r){let s=e[a],n=r[a];/^on[A-Z]/.test(a)?s&&n?t[a]=(...e)=>{n(...e),s(...e)}:s&&(t[a]=s):"style"===a?t[a]={...s,...n}:"className"===a&&(t[a]=[s,n].filter(Boolean).join(" "))}return{...e,...t}}(s,t.props);return t.type!==a.Fragment&&(l.ref=r?(0,n.t)(r,e):e),a.cloneElement(t,l)}return a.Children.count(t)>1?a.Children.only(null):null});o.displayName="SlotClone";var d=({children:e})=>(0,l.jsx)(l.Fragment,{children:e});function u(e){return a.isValidElement(e)&&e.type===d}var c=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"].reduce((e,r)=>{let t=a.forwardRef((e,t)=>{let{asChild:a,...s}=e,n=a?i:r;return"undefined"!=typeof window&&(window[Symbol.for("radix-ui")]=!0),(0,l.jsx)(n,{...s,ref:t})});return t.displayName=`Primitive.${r}`,{...e,[r]:t}},{});function f(e,r){e&&s.flushSync(()=>e.dispatchEvent(r))}},1524:(e,r,t)=>{"use strict";t.d(r,{c:()=>s});var a=t(2115);function s(e){let r=a.useRef(e);return a.useEffect(()=>{r.current=e}),a.useMemo(()=>(...e)=>r.current?.(...e),[])}},6611:(e,r,t)=>{"use strict";t.d(r,{N:()=>s});var a=t(2115),s=globalThis?.document?a.useLayoutEffect:()=>{}}},e=>{var r=r=>e(e.s=r);e.O(0,[2992,3644,8249,9680,615,6814,8441,1517,7358],()=>r(342)),_N_E=e.O()}]);